{
  "hash": "8bff2900da5dd2e51d1abd87fbd379e9",
  "result": {
    "markdown": "---\ntitle: \"Blog Post 4\"\nauthor: \"\"\ndate: \"2024-04-10\"\ndate-modified: \"2024-04-10\"\ndraft: FALSE\n---\n\n\nFor Blog Post 4, we adjust the data further to seperate the dataset according to different indicators.\n\n\nThen, we use Age as the predictor (a categorical variable) and Indicator Value as the response variable to run a regression. As the result we find different coefficient for different age groups.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(lmtest)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: zoo\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'zoo'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    as.Date, as.Date.numeric\n```\n:::\n\n```{.r .cell-code}\nlibrary(car)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: carData\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'car'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:dplyr':\n\n    recode\n```\n:::\n\n```{.r .cell-code}\nmydata <- read.csv(\"~/Downloads/MA 415/final-project-group-11/posts/2024-04-10-blog-post-4/Mental_Health_Care_in_the_Last_4_Weeks_.csv\")\n\nfiltered_data <- mydata %>% \n  filter(Group == 'By Age')\n\ndata_indicator1 <- filtered_data %>% filter(Indicator == \"Took Prescription Medication for Mental Health, Last 4 Weeks\")\ndata_indicator2 <- filtered_data %>% filter(Indicator == \"Received Counseling or Therapy, Last 4 Weeks\")\ndata_indicator3 <- filtered_data %>% filter(Indicator == \"Took Prescription Medication for Mental Health And/Or Received Counseling or Therapy, Last 4 Weeks\")\ndata_indicator4 <- filtered_data %>% filter(Indicator == \"Needed Counseling or Therapy But Did Not Get It, Last 4 Weeks\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_indicator1$Subgroup <- factor(data_indicator1$Subgroup, levels = c(\"80 years and above\", \n                                                   \"18 - 29 years\", \n                                                   \"30 - 39 years\", \n                                                   \"40 - 49 years\", \n                                                   \"50 - 59 years\", \n                                                   \"60 - 69 years\", \n                                                   \"70 - 79 years\"))\n\ndata_indicator1 <- data_indicator1 %>%\n  mutate(across(.cols = Subgroup, \n                .fns = ~ model.matrix(~ . - 1, data = data.frame(.))))\n\ndata_indicator2$Subgroup <- factor(data_indicator2$Subgroup, levels = c(\"80 years and above\", \n                                                   \"18 - 29 years\", \n                                                   \"30 - 39 years\", \n                                                   \"40 - 49 years\", \n                                                   \"50 - 59 years\", \n                                                   \"60 - 69 years\", \n                                                   \"70 - 79 years\"))\n\ndata_indicator2 <- data_indicator2 %>%\n  mutate(across(.cols = Subgroup, \n                .fns = ~ model.matrix(~ . - 1, data = data.frame(.))))\n\ndata_indicator3$Subgroup <- factor(data_indicator3$Subgroup, levels = c(\"80 years and above\", \n                                                   \"18 - 29 years\", \n                                                   \"30 - 39 years\", \n                                                   \"40 - 49 years\", \n                                                   \"50 - 59 years\", \n                                                   \"60 - 69 years\", \n                                                   \"70 - 79 years\"))\n\ndata_indicator3 <- data_indicator3 %>%\n  mutate(across(.cols = Subgroup, \n                .fns = ~ model.matrix(~ . - 1, data = data.frame(.))))\n\ndata_indicator4$Subgroup <- factor(data_indicator4$Subgroup, levels = c(\"80 years and above\", \n                                                   \"18 - 29 years\", \n                                                   \"30 - 39 years\", \n                                                   \"40 - 49 years\", \n                                                   \"50 - 59 years\", \n                                                   \"60 - 69 years\", \n                                                   \"70 - 79 years\"))\n\ndata_indicator4 <- data_indicator4 %>%\n  mutate(across(.cols = Subgroup, \n                .fns = ~ model.matrix(~ . - 1, data = data.frame(.))))\n```\n:::\n\n\n## Indicator 1\n\n\n::: {.cell}\n\n```{.r .cell-code}\nY <- data_indicator1$Value\nX1 <- data_indicator1$Subgroup\n\nmodel <- lm(Y~X1, data = data_indicator1)\nmodel\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = Y ~ X1, data = data_indicator1)\n\nCoefficients:\n                 (Intercept)  X1Subgroup80 years and above  \n                      19.258                        -4.218  \n     X1Subgroup18 - 29 years       X1Subgroup30 - 39 years  \n                       1.824                         2.324  \n     X1Subgroup40 - 49 years       X1Subgroup50 - 59 years  \n                       2.876                         3.524  \n     X1Subgroup60 - 69 years       X1Subgroup70 - 79 years  \n                       2.294                            NA  \n```\n:::\n:::\n\n\n## Indicator 2\n\n\n::: {.cell}\n\n```{.r .cell-code}\nY2 <- data_indicator2$Value\nX2 <- data_indicator2$Subgroup\n\nmodel <- lm(Y2~X2, data = data_indicator2)\nmodel\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = Y2 ~ X2, data = data_indicator2)\n\nCoefficients:\n                 (Intercept)  X2Subgroup80 years and above  \n                      4.1697                       -0.5215  \n     X2Subgroup18 - 29 years       X2Subgroup30 - 39 years  \n                     11.0727                       10.2939  \n     X2Subgroup40 - 49 years       X2Subgroup50 - 59 years  \n                      7.2576                        4.8848  \n     X2Subgroup60 - 69 years       X2Subgroup70 - 79 years  \n                      1.9424                            NA  \n```\n:::\n:::\n\n\n## Indicator 3\n\n\n::: {.cell}\n\n```{.r .cell-code}\nY3 <- data_indicator3$Value\nX3 <- data_indicator3$Subgroup\n\nmodel <- lm(Y3~X3, data = data_indicator3)\nmodel\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = Y3 ~ X3, data = data_indicator3)\n\nCoefficients:\n                 (Intercept)  X3Subgroup80 years and above  \n                      20.403                        -3.936  \n     X3Subgroup18 - 29 years       X3Subgroup30 - 39 years  \n                       6.521                         6.779  \n     X3Subgroup40 - 49 years       X3Subgroup50 - 59 years  \n                       5.564                         5.061  \n     X3Subgroup60 - 69 years       X3Subgroup70 - 79 years  \n                       2.779                            NA  \n```\n:::\n:::\n\n\n## Indicator 4\n\n\n::: {.cell}\n\n```{.r .cell-code}\nY4 <- data_indicator4$Value\nX4 <- data_indicator4$Subgroup\n\nmodel <- lm(Y4~X4, data = data_indicator4)\nmodel\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = Y4 ~ X4, data = data_indicator4)\n\nCoefficients:\n                 (Intercept)  X4Subgroup80 years and above  \n                      3.2636                        0.1402  \n     X4Subgroup18 - 29 years       X4Subgroup30 - 39 years  \n                     16.5848                       12.3030  \n     X4Subgroup40 - 49 years       X4Subgroup50 - 59 years  \n                      8.5818                        5.8848  \n     X4Subgroup60 - 69 years       X4Subgroup70 - 79 years  \n                      2.5121                            NA  \n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}